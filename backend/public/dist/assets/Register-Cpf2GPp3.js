import{r as n,j as e}from"./index-DgWF9MBv.js";import{m as d}from"./proxy-C2YUrH8b.js";function E(){const[a,h]=n.useState({name:"",username:"",email:"",password:"",confirmPassword:""}),[x,f]=n.useState(!1),[b,o]=n.useState(""),[u,y]=n.useState(""),[g,j]=n.useState([]),[l,w]=n.useState(!1),[S,k]=n.useState(""),p=r=>{const{name:t,value:i}=r.target;h(s=>({...s,[t]:i}))},v=()=>!a.name.trim()||!a.email.trim()||!a.password.trim()?(o("Please fill name, email, and password."),!1):a.confirmPassword&&a.confirmPassword!==a.password?(o("Password confirmation does not match."),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email.trim())?(o(""),!0):(o("Please enter a valid email address."),!1),A=r=>{if(r==null)return"N/A";const t=typeof r=="string"?r:String(r);return t.length<=10?t:`${t.slice(0,4)}...${t.slice(-4)}`},C=r=>{if(!r)return"N/A";const t=new Date(r);return Number.isNaN(t.getTime())?"N/A":t.toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},m=async()=>{try{w(!0),k("");const r=localStorage.getItem("token");if(!r)throw new Error("Missing authentication token");const t=await fetch("https://molsongbsspaces.onrender.com/api/user/all",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!t.ok){const T=await t.json().catch(()=>({}));throw new Error(T.message||"Failed to fetch users")}const i=await t.json(),s=Array.isArray(i?.data)?i.data:Array.isArray(i)?i:[];j(s)}catch(r){console.error("Error fetching users:",r),j([]),k(r.message||"Unable to load users")}finally{w(!1)}};n.useEffect(()=>{m().catch(()=>{})},[]);const R=async r=>{if(r.preventDefault(),!!v()){f(!0),o(""),y("");try{const t=localStorage.getItem("token"),i=await fetch("https://molsongbsspaces.onrender.com/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({name:a.name.trim(),username:a.username.trim(),email:a.email.trim(),password:a.password})});if(!i.ok){const s=await i.json().catch(()=>({}));throw new Error(s.message||"Registration failed")}y("User successfully registered."),h({name:"",username:"",email:"",password:"",confirmPassword:""}),await m()}catch(t){console.error("Registration error:",t),o(t.message||"Registration error")}finally{f(!1)}}},c=n.useMemo(()=>Array.isArray(g)?g.map(r=>({id:r._id||r.id,name:r.name||r.fullName||"N/A",username:r.username||"N/A",email:r.email||"N/A",role:r.role||"user",createdAt:r.createdAt||r.created_at,status:r.status||"active"})).sort((r,t)=>{const i=r.createdAt?new Date(r.createdAt).getTime():0;return(t.createdAt?new Date(t.createdAt).getTime():0)-i}):[],[g]);return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 45%, #dbeafe 100%)",padding:"48px 24px"},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",position:"relative"},children:[e.jsx(d.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},style:{marginBottom:"32px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"18px",flexWrap:"wrap"},children:[e.jsx(d.div,{animate:{rotate:[0,4,-4,0],scale:[1,1.04,1]},transition:{duration:2.4,repeat:1/0,repeatDelay:3},style:{background:"linear-gradient(135deg, #0067AC, #1d4ed8)",borderRadius:"14px",padding:"14px",boxShadow:"0 10px 25px rgba(30, 64, 175, 0.25)"},children:e.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z",stroke:"#bfdbfe",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 22C4 17.5817 7.58172 14 12 14C16.4183 14 20 17.5817 20 22",stroke:"#bfdbfe",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"34px",fontWeight:"800",background:"linear-gradient(135deg, #0f172a, #1d4ed8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-0.4px",margin:0},children:"Register Users"}),e.jsx("p",{style:{color:"#475569",margin:"6px 0 0 0",fontSize:"16px",fontWeight:"500"},children:"Invite teammates and review who already has access to the workspace"})]})]})}),e.jsxs("div",{style:{display:"grid",gap:"28px"},children:[e.jsxs(d.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45},style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(241, 245, 249, 0.95))",border:"1px solid rgba(148, 163, 184, 0.25)",borderRadius:"18px",padding:"26px 28px 30px",width:"100%",boxShadow:"0 18px 40px rgba(15, 23, 42, 0.12)"},children:[e.jsx("h2",{style:{fontSize:"20px",color:"#0f172a",margin:"0 0 16px 0",fontWeight:"700"},children:"Invite a new user"}),b&&e.jsx("div",{style:{marginBottom:"12px",color:"#991b1b",background:"rgba(248, 113, 113, 0.15)",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(248, 113, 113, 0.25)"},children:b}),u&&e.jsx("div",{style:{marginBottom:"12px",color:"#166534",background:"rgba(34, 197, 94, 0.15)",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(34, 197, 94, 0.25)"},children:u}),e.jsxs("form",{onSubmit:R,style:{display:"grid",gap:"16px"},children:[e.jsxs("div",{style:{display:"grid",gap:"14px",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[e.jsx("input",{name:"name",placeholder:"Full name",value:a.name,onChange:p,style:{padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500"}}),e.jsx("input",{name:"username",placeholder:"Username",value:a.username,onChange:p,style:{padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500"}}),e.jsx("input",{name:"email",placeholder:"Email",type:"email",value:a.email,onChange:p,style:{padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500"}}),e.jsx("input",{name:"password",placeholder:"Password",type:"password",value:a.password,onChange:p,style:{padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500"}}),e.jsx("input",{name:"confirmPassword",placeholder:"Confirm password",type:"password",value:a.confirmPassword,onChange:p,style:{padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500"}})]}),e.jsx(d.button,{type:"submit",whileHover:{y:-2,boxShadow:"0 18px 38px rgba(30, 64, 175, 0.25)"},whileTap:{scale:.98},disabled:x,style:{justifySelf:"flex-start",padding:"12px 24px",background:"linear-gradient(135deg, #1d4ed8, #3b82f6)",color:"#f8fafc",border:"none",borderRadius:"12px",fontWeight:"700",cursor:x?"not-allowed":"pointer",letterSpacing:"0.5px",opacity:x?.7:1,transition:"opacity 0.2s ease"},children:x?"Creating...":"Create account"})]})]}),e.jsxs(d.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45,delay:.1},style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.94), rgba(241, 245, 249, 0.98))",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"18px",padding:"24px",boxShadow:"0 20px 42px rgba(15, 23, 42, 0.12)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"12px",marginBottom:"18px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"20px",color:"#0f172a",margin:"0 0 4px 0",fontWeight:"700"},children:"Existing users"}),e.jsxs("p",{style:{color:"#64748b",margin:0,fontSize:"14px"},children:[c.length," user",c.length===1?"":"s"," found"]})]}),e.jsx(d.button,{onClick:()=>m(),whileHover:{scale:1.02},whileTap:{scale:.98},disabled:l,style:{padding:"8px 16px",borderRadius:"999px",border:"1px solid rgba(37, 99, 235, 0.25)",background:"linear-gradient(135deg, #eff6ff, #dbeafe)",color:"#1d4ed8",fontWeight:"600",cursor:l?"not-allowed":"pointer",boxShadow:"0 10px 20px rgba(59, 130, 246, 0.1)",opacity:l?.7:1},children:l?"Refreshing...":"Refresh list"})]}),S&&e.jsx("div",{style:{marginBottom:"14px",color:"#991b1b",background:"rgba(248, 113, 113, 0.12)",padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(248, 113, 113, 0.22)"},children:S}),e.jsx("div",{style:{overflowX:"auto",borderRadius:"14px",border:"1px solid rgba(148, 163, 184, 0.2)",background:"rgba(248, 250, 252, 0.85)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:"720px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"linear-gradient(135deg, rgba(226, 232, 240, 0.9), rgba(203, 213, 225, 0.7))",color:"#0f172a",textAlign:"left"},children:[e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"Name"}),e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"Username"}),e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"Email"}),e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"Role"}),e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"Created"}),e.jsx("th",{style:{padding:"14px 16px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.6px"},children:"ID"})]})}),e.jsx("tbody",{children:l&&c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:"20px",textAlign:"center",color:"#64748b"},children:"Loading users..."})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:"20px",textAlign:"center",color:"#94a3b8"},children:"No users found."})}):c.map(r=>e.jsxs("tr",{style:{borderTop:"1px solid rgba(148, 163, 184, 0.2)",background:"rgba(255, 255, 255, 0.7)"},children:[e.jsx("td",{style:{padding:"14px 16px",fontSize:"14px",color:"#0f172a",fontWeight:"600"},children:r.name}),e.jsx("td",{style:{padding:"14px 16px",fontSize:"14px",color:"#1e293b"},children:r.username}),e.jsx("td",{style:{padding:"14px 16px",fontSize:"14px",color:"#1e293b"},children:r.email}),e.jsx("td",{style:{padding:"14px 16px"},children:e.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 12px",borderRadius:"999px",background:r.role==="admin"?"linear-gradient(135deg, rgba(59, 130, 246, 0.18), rgba(37, 99, 235, 0.18))":"linear-gradient(135deg, rgba(34, 197, 94, 0.18), rgba(22, 163, 74, 0.18))",color:r.role==="admin"?"#1d4ed8":"#166534",fontSize:"12px",fontWeight:"600",border:r.role==="admin"?"1px solid rgba(37, 99, 235, 0.24)":"1px solid rgba(22, 163, 74, 0.24)"},children:r.role==="admin"?"Admin":"User"})}),e.jsx("td",{style:{padding:"14px 16px",fontSize:"13px",color:"#475569"},children:C(r.createdAt)}),e.jsx("td",{style:{padding:"14px 16px",fontFamily:"monospace",fontSize:"13px",color:"#64748b"},children:A(r.id)})]},r.id||r.email))})]})})]})]})]})})}export{E as default};
